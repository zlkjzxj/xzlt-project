<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zlkj.business.dao.TestUserMarkMapper">
    <resultMap id="testMarkResultMap" type="com.zlkj.business.dto.TestUserMarkDto">
        <id column="id" property="id"/>
        <result column="user_name" property="userName"/>
        <result column="user_id" property="userId"/>
        <result column="question_type_id" property="questionTypeId"/>
        <result column="test_result" property="testResult"/>
        <result column="cp_sign" property="cpSign"/>
        <result column="test_job" property="testJob"/>
        <result column="create_time" property="createTime"/>
        <collection property="results" ofType="com.zlkj.business.entity.TestUserMarkResult">
            <id column="rid" property="id"/>
            <result column="user_id" property="userId"/>
            <result column="question_type_id" property="questionTypeId"/>
            <result column="code" property="code"/>
            <result column="value" property="value"/>
            <result column="rctime" property="createTime"/>
        </collection>
    </resultMap>
    <select id="getUserMarkList" resultMap="testMarkResultMap" parameterType="java.lang.Integer">
        SELECT
            m.*,
            r.id          AS rid,
            r.create_time AS rctime,
            r.code,
            r.value
        FROM test_user_mark m LEFT JOIN test_user_mark_result r
                ON (m.user_id = r.user_id AND m.question_type_id = r.question_type_id)
        WHERE m.user_id = #{userId}


    </select>

</mapper>